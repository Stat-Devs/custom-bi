{"visual":{"name":"rvisual3rdattemp","displayName":"rvisual3rdattemp","guid":"rvisual3rdattempB340EA341708495FBA3C30A83BD1B946","visualClassName":"Visual","version":"1.0.0","description":"VerticalLineChart","supportUrl":"www.statdevs.com","gitHubUrl":"https://github.com/Stat-Devs/custom-bi"},"author":{"name":"StatDevs","email":"info@statdevs.com"},"apiVersion":"5.1.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Values","kind":"GroupingOrMeasure","name":"Values"}],"dataViewMappings":[{"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"Values"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"############### Utility functions ###############\nlibraryRequireInstall = function(packageName, ...)\n{\n  if(!require(packageName, character.only = TRUE)) \n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\n}\n\nlibraryRequireInstall(\"xml2\")\nlibraryRequireInstall(\"htmlwidgets\")\n\ninternalSaveWidget <- function(widget, fname)\n{\n  tempFname = paste(fname, \".tmp\", sep=\"\")\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\n  FlattenHTML(tempFname, fname)\n}\n\nFlattenHTML <- function(fnameIn, fnameOut)\n{\n  # Read and parse HTML file\n  # Embed all js and css files into one unified file\n  \n  if(!file.exists(fnameIn))\n    return(FALSE)\n  \n  dir = dirname(fnameIn)\n  html = read_html(fnameIn, useInternal = TRUE)\n  top = xml_root(html)\n  \n  # extract all <script> tags with src value\n  srcNode=xml_find_all(top, '//script[@src]')\n  for (node in srcNode)\n  {\n    b = xml_attrs(node)\n    fname = file.path(dir, b['src'])\n    alternateSrc = FindSrcReplacement(fname)\n    if (!is.null(alternateSrc))\n    {\n      s = alternateSrc\n      names(s) = 'src'\n      newNode = xml_new_root(\"script\")\n      xml_set_attrs(newNode, s)\n      xml_replace(node, newNode)\n    }else{\n      str=ReadFileForEmbedding(fname);\n      if (!is.null(str))\n      {      \n        newNode = xml_new_root(\"script\",str)\n        xml_set_attrs( newNode, c( type = \"text/javascript\") )\n        xml_replace(node, newNode)\n      }\n    }\n  }\n  \n  # extract all <link> tags with src value\n  linkNode=xml_find_all(top, '//link[@href]')\n  for (node in linkNode)\n  {\n    b = xml_attrs(node)\n    fname = file.path(dir, b['href'])\n    str = ReadFileForEmbedding(fname, FALSE);\n    if (!is.null(str))\n    {\n      newNode = xml_new_root(\"style\", str)\n      xml_replace(node, newNode)\n    }\n  }\n  \n  write_xml(html, file = fnameOut)\n  return(TRUE)\n}\n\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\n{\n  data = ReadFullFile(fname)\n  if (is.null(data))\n    return(NULL)\n\n  str = paste(data, collapse ='\\n')\n  if (addCdata) {\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\n  }\n  return(str)\n}\n\nReadFullFile <- function(fname)\n{\n  if(!file.exists(fname))\n    return(NULL)\n  \n  con = file(fname, open = \"r\")\n  data = readLines(con)\n  close(con)\n  return(data)\n}\n\nFindSrcReplacement <- function(str)\n{\n  # finds reference to 'plotly' js and replaces with a version from CDN\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\n  str <- iconv(str, to=\"UTF-8\")\n  pattern = \"plotly-(\\\\w.+)/plotly-latest.min.js\"\n  match1=regexpr(pattern, str)\n  attr(match1, 'useBytes') <- FALSE\n  strMatch=regmatches(str, match1, invert = FALSE)\n  if (length(strMatch) == 0) return(NULL)\n  \n  pattern2 = \"-(\\\\d.+)/\"\n  match2 = regexpr(pattern2, strMatch[1])\n  attr(match2, 'useBytes') <- FALSE\n  strmatch = regmatches(strMatch[1], match2)\n  if (length(strmatch) == 0) return(NULL)\n  \n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\n  # This matches the specific version used in the plotly package used.\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\n  return(str)\n}\n\nReadFullFileReplaceString <- function(fnameIn, fnameOut, sourceString,targetString) {\n  # Replaces texts in file\n  # This makes it possible to replace e.g. paddings in the generated html widget code\n  if(!file.exists(fnameIn))\n    return(NULL)\n  tx  <- readLines(fnameIn,encoding = \"UTF-8\")\n  tx2  <- gsub(pattern = sourceString, replace = targetString, x = tx)\n  writeLines(tx2, con = fnameOut)\n}\n#################################################\n\r\n\r\n############### Library Declarations ###############\r\nlibraryRequireInstall(\"ggplot2\");\r\nlibraryRequireInstall(\"plotly\")\r\n####################################################\r\n\r\n################### Actual code ####################\r\nBaseColour = \"#777777\"\r\n  LightGrey = \"#01B8AA\"\r\n    \r\n  \r\n  # Custom line chart \r\n  bit_depth_plot = \r\n    ggplot(Values) + \r\n    geom_line(aes(x = hole_dep_ft, y = datetime),alpha = 0.7, color = \"blue\", orientation = \"y\", linewidth = 0.7) +\r\n    \r\n    theme_bw()\r\n  \r\n  # Build Power BI theme ---------------------------------------------------------\r\n  \r\n  bit_depth_plot_themed_bi = bit_depth_plot + theme(\r\n    axis.text = element_text(size = 11, family = \" Segoe UI\", colour = BaseColour),\r\n    axis.ticks = element_blank(), \r\n    axis.title = element_text(size = 11, family = \"Segoe UI\", colour = BaseColour),\r\n    panel.grid.major.y = element_line( size = .1, color = BaseColour),   \r\n    panel.grid.major.x = element_blank(),   \r\n    panel.background = element_blank()  \r\n  )\r\n  \r\n  \r\n####################################################\r\n\r\n############# Create and save widget ###############\r\np = ggplotly(bit_depth_plot_themed_bi);\r\ninternalSaveWidget(p, 'out.html');\r\n####################################################\r\n\r\n\r\n"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}}},"suppressDefaultTitle":true,"privileges":[]},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"xml2","displayName":"xml2","url":"https://cran.r-project.org/web/packages/xml2/index.html"}]},"content":{"js":"var rvisual3rdattempB340EA341708495FBA3C30A83BD1B946;(()=>{\"use strict\";var e={543:(e,t,i)=>{i.d(t,{Kq:()=>r,ME:()=>l,Tx:()=>o});var a=i(738);let s=0;function o(){s=0}function r(e,t){let i=[];if(!e||!e.hasChildNodes())return;let a=e.children;for(let e=0;e<a.length;e++){let s;s=\"script\"===a.item(e).nodeName.toLowerCase()?n(a.item(e)):a.item(e).cloneNode(!0),t.appendChild(s),i.push(s)}return i}function n(e){let t=document.createElement(\"script\"),i=e.attributes;for(let e=0;e<i.length;e++)t.setAttribute(i[e].name,i[e].textContent),\"src\"===i[e].name.toLowerCase()&&(s++,t.onload=()=>{s--});return t.innerHTML=e.innerHTML,t}function l(){let e=a.setInterval((()=>{0===s&&(a.clearInterval(e),a.hasOwnProperty(\"HTMLWidgets\")&&a.HTMLWidgets.staticRender&&a.HTMLWidgets.staticRender())}),100)}},160:(e,t,i)=>{i.d(t,{E:()=>n});var a=i(84),s=a.Zb,o=a.Hn;class r extends s{constructor(){super(...arguments),this.provider=void 0,this.source=void 0,this.name=\"rcv_script\",this.displayName=\"rcv_script\",this.slices=[this.provider,this.source]}}class n extends o{constructor(){super(...arguments),this.rcvScriptCard=new r,this.cards=[this.rcvScriptCard]}}},286:(e,t,i)=>{i.d(t,{u:()=>d});var a,s=i(261),o=i(543),r=i(160),n=i(738);!function(e){e[e.Data=2]=\"Data\",e[e.Resize=4]=\"Resize\",e[e.ViewMode=8]=\"ViewMode\",e[e.Style=16]=\"Style\",e[e.ResizeEnd=32]=\"ResizeEnd\",e[e.All=62]=\"All\"}(a||(a={}));const l=[a.Resize,a.ResizeEnd,a.Resize+a.ResizeEnd];class d{constructor(e){this.formattingSettingsService=new s.Z,e&&e.element&&(this.rootElement=e.element),this.headNodes=[],this.bodyNodes=[]}update(e){if(!(e&&e.type&&e.viewport&&e.dataViews&&0!==e.dataViews.length&&e.dataViews[0]))return;const t=e.dataViews[0];this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(r.E,e.dataViews);let i=null;t.scriptResult&&t.scriptResult.payloadBase64&&(i=t.scriptResult.payloadBase64),-1===l.indexOf(e.type)?i&&this.injectCodeFromPayload(i):this.onResizing(e.viewport)}onResizing(e){}injectCodeFromPayload(e){if((0,o.Tx)(),!e)return;let t=document.createElement(\"html\");try{t.innerHTML=n.atob(e)}catch(e){return}if(0===this.headNodes.length){for(;this.headNodes.length>0;){let e=this.headNodes.pop();document.head.removeChild(e)}let e=t.getElementsByTagName(\"head\");if(e&&e.length>0){let t=e[0];this.headNodes=(0,o.Kq)(t,document.head)}}for(;this.bodyNodes.length>0;){let e=this.bodyNodes.pop();this.rootElement.removeChild(e)}let i=t.getElementsByTagName(\"body\");if(i&&i.length>0){let e=i[0];this.bodyNodes=(0,o.Kq)(e,this.rootElement)}(0,o.ME)()}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},84:(e,t,i)=>{i.d(t,{Hn:()=>s,Zb:()=>o});class a{}class s{}class o extends a{getFormattingCard(e,t,i){return{displayName:i&&this.displayNameKey?i.getDisplayName(this.displayNameKey):this.displayName,description:i&&this.descriptionKey?i.getDisplayName(this.descriptionKey):this.description,groups:[t],uid:e,analyticsPane:this.analyticsPane}}}},261:(e,t,i)=>{i.d(t,{Z:()=>a});const a=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var i,a,s;let o=new e,r=null===(a=null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.metadata)||void 0===a?void 0:a.objects;return r&&(null===(s=o.cards)||void 0===s||s.forEach((e=>{var t,i,a;null===(t=null==e?void 0:e.slices)||void 0===t||t.forEach((t=>{null==t||t.setPropertiesValues(r,e.name)})),null===(a=null===(i=null==e?void 0:e.container)||void 0===i?void 0:i.containerItems)||void 0===a||a.forEach((t=>{var i;null===(i=null==t?void 0:t.slices)||void 0===i||i.forEach((t=>{null==t||t.setPropertiesValues(r,e.name)}))}))}))),o}buildFormattingModel(e){var t;let i={cards:[]};return null===(t=e.cards)||void 0===t||t.forEach((e=>{if(!e)return;const t=e.name,a=e.name+\"-group\";let s={displayName:void 0,slices:[],uid:a},o=e.getFormattingCard(t,s,this.localizationManager);i.cards.push(o);const r={};if(e.container){const i=e.container,n=a+\"-container\",l={displayName:this.localizationManager&&i.displayNameKey?this.localizationManager.getDisplayName(i.displayNameKey):i.displayName,description:this.localizationManager&&i.descriptionKey?this.localizationManager.getDisplayName(i.descriptionKey):i.description,containerItems:[],uid:n};i.containerItems.forEach((e=>{const i=e.displayNameKey?e.displayNameKey:e.displayName,a=n+i;let s={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:a};this.buildFormattingSlices(e.slices,t,r,o,s.slices),l.containerItems.push(s)})),s.container=l}e.slices&&this.buildFormattingSlices(e.slices,t,r,o,s.slices),o.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e)})),i}buildFormattingSlices(e,t,i,a,s){null==e||e.forEach((e=>{let o=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);o&&(void 0===i[e.name]?i[e.name]=0:(i[e.name]++,o.uid=`${o.uid}-${i[e.name]}`),e.topLevelToggle?(o.suppressDisplayName=!0,a.topLevelToggle=o):s.push(o))}))}getRevertToDefaultDescriptor(e){var t,i;const a={};let s=[],o=this.getSlicesRevertToDefaultDescriptor(e.name,e.slices,a),r=[];return null===(i=null===(t=e.container)||void 0===t?void 0:t.containerItems)||void 0===i||i.forEach((t=>{r=r.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a))})),s=o.concat(r),s}getSlicesRevertToDefaultDescriptor(e,t,i){let a=[];return null==t||t.forEach((t=>{t&&!i[t.name]&&(i[t.name]=!0,a=a.concat(t.getRevertToDefaultDescriptor(e)))})),a}}},738:e=>{e.exports=Function(\"return this\")()}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var a={};(()=>{i.r(a),i.d(a,{default:()=>o});var e=i(286),t=i(738).powerbi,s={name:\"rvisual3rdattempB340EA341708495FBA3C30A83BD1B946\",displayName:\"rvisual3rdattemp\",class:\"Visual\",apiVersion:\"5.1.0\",create:t=>{if(e.u)return new e.u(t);throw\"Visual instance not found\"},createModalDialog:(e,t,i)=>{const a=globalThis.dialogRegistry;e in a&&new a[e](t,i)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.rvisual3rdattempB340EA341708495FBA3C30A83BD1B946=s);const o=s})(),rvisual3rdattempB340EA341708495FBA3C30A83BD1B946=a})();","css":"","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":"","toolsVersion":null}